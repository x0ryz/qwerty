<form action="{% url 'cart:cart_add' product.id %}" method="post" id="add-to-cart-form">
    {% csrf_token %}
    <input type="hidden" name="quantity" value="1">
    <input type="hidden" name="variant_id" value="{{ selected_variant.id|default:'' }}">

    <div class="space-y-6 mb-8 bg-white p-6 border-2 border-black shadow-[2px_2px_0_0_#000]">
        {% if attribute_groups %}
            {% for group in attribute_groups %}
                <div>
                    <label class="block font-bold mb-3 uppercase text-sm">{{ group.name }}:</label>
                    <div class="flex flex-wrap gap-2">
                        {% for value in group.values %}
                            <button type="button"
                                    hx-get="{{ value.update_url }}"
                                    hx-push-url="true"
                                    hx-target="#add-to-cart-form"
                                    hx-swap="outerHTML"
                                    class="px-4 py-2 border-2 text-sm font-bold transition-all
                                    {% if value.is_selected %}
                                        border-black bg-black text-white shadow-[2px_2px_0_0_#000]
                                    {% else %}
                                        border-gray-300 bg-transparent text-gray-500 hover:border-black hover:text-black
                                    {% endif %}">
                                {{ value.label }}
                            </button>
                        {% endfor %}
                    </div>
                </div>
            {% endfor %}
        {% else %}
            <p class="text-sm font-bold text-gray-500">SINGLE ITEM</p>
        {% endif %}
    </div>

    <div class="mt-auto space-y-4">
        <button type="submit"
                {% if not selected_variant %}disabled{% endif %}
                class="w-full px-6 py-4 font-mono font-bold text-lg uppercase transition-all border-2 border-black shadow-[4px_4px_0_0_#000]
                {% if selected_variant %}
                    bg-black text-white hover:bg-gray-800
                {% else %}
                    bg-gray-200 text-gray-400 cursor-not-allowed opacity-50
                {% endif %}">
            {% if selected_variant %}
                ADD TO CART // ${{ selected_variant.price }}
            {% else %}
                SELECT OPTIONS
            {% endif %}
        </button>
        <p class="text-xs text-center text-gray-500">FREE SHIPPING ON ORDERS OVER $200.</p>
    </div>
</form>